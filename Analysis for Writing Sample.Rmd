---
title: "Data Analysis for Red Lines That Bind: International Law and Domestic Audience Costs in U.S. Counterproliferation Policy"
author: "Ethan Lee"
date: "23 Nov 2025"
output: pdf_document
---

## Prepping the dataset in R.

```{r}
rm(list=ls())
#setwd("YOUR/WORKING/DIRECTORY/HERE")

packages <- c(
  "plyr","dplyr","ggplot2","stargazer","cowplot","gridExtra",
  "forcats","reshape2","tidyr","broom","purrr","survey"
)

invisible(lapply(packages, library, character.only = TRUE))

d_all <- read.csv("Hypothetical Foreign Policy Scenario_3.4.2023_18.16.csv")

d_all$check <- ifelse(d_all$QID23 == 4 | d_all$QID67 == 4, 1, 0)
for(i in 1:nrow(d_all)){
  if(d_all$status[i] == 1){
  d_all$check[i] <- 0
  }
}
for(i in 1:nrow(d_all)){
  if(d_all$finished[i] == 0){
  d_all$check[i] <- 0
  }
}
d <- filter(d_all, check == 1)

```

## Preparing data for analysis

```{r}
d$QID23 <- as.numeric(d$QID23)
d$QID67 <- as.numeric(d$QID67)
d$QID40 <- as.numeric(d$QID40)
d$QID42 <- as.numeric(d$QID42)
d$QID43 <- as.numeric(d$QID43)
d$QID44 <- as.numeric(d$QID44)
d$QID45 <- as.numeric(d$QID45)
d$QID70 <- as.numeric(d$QID70)
d$QID71 <- as.numeric(d$QID71)
d$QID72 <- as.numeric(d$QID72)
d$QID48 <- (as.numeric(d$QID48)/2)

for(i in 1:nrow(d)){
  d$QID49[i] <- as.numeric(round(sum(as.numeric(strsplit(d$QID49[i], ",")[[1]])), 1))
}
d$QID50 <- as.numeric(d$QID50)
d$QID50 <- ifelse(d$QID50 == 1, .5, 0)
for(i in 1:nrow(d)){
  d$lawknowledge_score[i] <- ((as.numeric(d$QID49[i]) + d$QID50[i])/1.5)
}

d$QID51 <- as.numeric(d$QID51)
d$QID52 <- as.numeric(d$QID52)
d$QID53 <- as.numeric(d$QID53)
for(i in 1:nrow(d)){
  d$milassert_score[i] <- mean(c(d$QID51[i], d$QID52[i], d$QID53[i]))
}

d$QID54 <- as.numeric(d$QID54)
d$QID55 <- as.numeric(d$QID55)

d$QID56 <- as.numeric(d$QID56)
d$QID57 <- as.numeric(d$QID57)
for(i in 1:nrow(d)){
  d$chauvinism_score[i] <- mean(c(d$QID56[i], d$QID57[i]))
}

d$QID58 <- as.numeric(d$QID58)

d$QID59 <- as.numeric(d$QID59)

d$QID73 <- as.numeric(d$QID73)
d$QID74 <- as.numeric(d$QID74)
d$QID75 <- as.numeric(d$QID75)
for(i in 1:nrow(d)){
  d$govtrust_score[i] <- mean(c(d$QID73[i], d$QID74[i], d$QID75[i]))
}


d$QID76 <- as.numeric(d$QID76)
d$QID77 <- as.numeric(d$QID77)
d$QID78 <- as.numeric(d$QID78)

d$QID60 <- as.numeric(d$QID60)
d$QID61 <- as.numeric(d$QID61)
d$QID63 <- as.numeric(d$QID63)
d$QID64 <- as.numeric(d$QID64)
d$age <- as.numeric(d$age)

d$QID65 <- as.numeric(d$QID65)
d$election_trump <- ifelse(d$QID65 == 1, 1, 0)
d$election_biden <- ifelse(d$QID65 == 2, 1, 0)

d$gender <- as.numeric(d$gender)
d$gender_male <- ifelse(d$gender == 1, 1, 0)
num_males <- sum(d$gender_male)
num_females <- sum(d$gender_female)


d$hhi <- as.numeric(d$hhi)
d$hhi_above70k <- ifelse(d$hhi >= 13, 1, 0)
num_hhi_above70k <- sum(d$hhi_above70k)

d$ethnicity_scored <- ifelse(d$ethnicity == 1 & d$hispanic == 1, "NHW",
                          ifelse(d$ethnicity == 1 & d$hispanic != 1 & 
                                   d$hispanic != 15, "H",
                                 ifelse(d$ethnicity == 2, "B", "Other")))
d$ethnicity_scored <- factor(d$ethnicity_scored)
d$ethnicity_scored <- relevel(d$ethnicity_scored, 
                              ref = "NHW")
num_NHW <- sum(d$ethnicity_scored == "NHW")
num_H <- sum(d$ethnicity_scored == "H")
num_B <- sum(d$ethnicity_scored == "B")
num_Other <- sum(d$ethnicity_scored == "Other")

d$education <- as.numeric(d$education)
d$education_bachelorsplus <- 
  ifelse(d$education >= 6, 1, 0)
num_education_bachelorsplus <- sum(d$education_bachelorsplus)

d$political_party <- as.numeric(d$political_party)
d$political_party_dem <- ifelse(d$political_party == 1, 2, 0)
d$political_party_dem <- ifelse(d$political_party == 2, 1, 0)
num_political_party_dem <- 
  sum(d$political_party == 1 | d$political_party == 2)
d$political_party_rep <- ifelse(d$political_party == 9, 1, 0)
d$political_party_rep <- 
  ifelse(d$political_party == 10, 2, 0)
num_political_party_rep <- 
  sum(d$political_party == 9 | d$political_party == 10)
d$political_party_independent <- 
  ifelse(d$political_party == 3 | 
                                        d$political_party == 5, 1, 0)
d$political_party_independent <- 
  ifelse(d$political_party == 4, 2, 0)
num_political_party_independent <- 
  sum(d$political_party == 3 | d$political_party == 4 | 
                       d$political_party == 5)
d$political_party_other <- ifelse(d$political_party == 6 | d$political_party == 7 | 
                          d$political_party == 8, 1, 0)
num_political_party_other <- sum(d$political_party_other)

```

## Subset Based on Treatment Group 

```{r}
num_T0 <- sum(ifelse(d$Treatment == 0, 1, 0))
T0 <- subset(d, Treatment == 0)
T0$ethnicity_scored <- factor(T0$ethnicity_scored)
T0_QID40_avg <- mean(T0$QID40)
T0_QID42_avg <- mean(T0$QID42)
T0_QID43_avg <- mean(T0$QID43)
T0_QID44_avg <- mean(T0$QID44)

num_T1 <- sum(ifelse(d$Treatment == 1, 1, 0))
T1 <- subset(d, Treatment == 1)
T1$ethnicity_scored <- factor(T1$ethnicity_scored)
T1_QID40_avg <- mean(T1$QID40)
T1_QID42_avg <- mean(T1$QID42)
T1_QID43_avg <- mean(T1$QID43)
T1_QID44_avg <- mean(T1$QID44)

num_T2 <- sum(ifelse(d$Treatment == 2, 1, 0))
T2 <- subset(d, Treatment == 2)
T2$ethnicity_scored <- factor(T2$ethnicity_scored)
T2_QID40_avg <- mean(T2$QID40)
T2_QID42_avg <- mean(T2$QID42)
T2_QID43_avg <- mean(T2$QID43)
T2_QID44_avg <- mean(T2$QID44)

num_T3 <- sum(ifelse(d$Treatment == 3, 1, 0))
T3 <- subset(d, Treatment == 3)
T3$ethnicity_scored <- factor(T3$ethnicity_scored)
T3_QID40_avg <- mean(T3$QID40)
T3_QID42_avg <- mean(T3$QID42)
T3_QID43_avg <- mean(T3$QID43)
T3_QID44_avg <- mean(T3$QID44)

num_T4 <- sum(ifelse(d$Treatment == 4, 1, 0))
T4 <- subset(d, Treatment == 4)
T4$ethnicity_scored <- factor(T4$ethnicity_scored)
T4_QID40_avg <- mean(T4$QID40)
T4_QID42_avg <- mean(T4$QID42)
T4_QID43_avg <- mean(T4$QID43)
T4_QID44_avg <- mean(T4$QID44)
T4_QID45_avg <- mean(T4$QID45)

num_T5 <- sum(ifelse(d$Treatment == 5, 1, 0))
T5 <- subset(d, Treatment == 5)
T5$ethnicity_scored <- factor(T5$ethnicity_scored)
T5_QID40_avg <- mean(T5$QID40)
T5_QID42_avg <- mean(T5$QID42)
T5_QID43_avg <- mean(T5$QID43)
T5_QID44_avg <- mean(T5$QID44)
T5_QID45_avg <- mean(T5$QID45)

num_T6 <- sum(ifelse(d$Treatment == 6, 1, 0))
T6 <- subset(d, Treatment == 6)
T6$ethnicity_scored <- factor(T6$ethnicity_scored)
T6_QID40_avg <- mean(T6$QID40)
T6_QID42_avg <- mean(T6$QID42)
T6_QID43_avg <- mean(T6$QID43)
T6_QID44_avg <- mean(T6$QID44)
T6_QID45_avg <- mean(T6$QID45)

audience <- rbind(T6, T3, T0)
audience$ethnicity_scored <- factor(audience$ethnicity_scored)
audience$subset_distinction <- ifelse(audience$Treatment == 6 | 
                                      audience$Treatment == 3, 1, 0)

belligerence <- rbind(T5, T2, T0)
belligerence$ethnicity_scored <- factor(belligerence$ethnicity_scored)
belligerence$subset_distinction <- ifelse(belligerence$Treatment == 5 |
                                          belligerence$Treatment == 2, 1, 0)

inconsistency <- rbind(T6, T5, T3, T2)
inconsistency$ethnicity_scored <- factor(inconsistency$ethnicity_scored)
inconsistency$subset_distinction <- ifelse(inconsistency$Treatment == 6 |
                                           inconsistency$Treatment == 3, 1, 0)

incompetence <- rbind(T5, T4, T2, T1)
incompetence$ethnicity_scored <- factor(incompetence$ethnicity_scored)
incompetence$subset_distinction <- ifelse(incompetence$Treatment == 5 |
                                          incompetence$Treatment == 2, 1, 0)

legal_audience <- rbind(T3, T0)
legal_audience$ethnicity_scored <- factor(legal_audience$ethnicity_scored)
legal_audience$subset_distinction <- ifelse(legal_audience$Treatment == 3, 1, 0)

illegal_audience <- rbind(T6, T0)
illegal_audience$ethnicity_scored <- 
  factor(illegal_audience$ethnicity_scored)
illegal_audience$subset_distinction <- 
  ifelse(illegal_audience$Treatment == 6, 1, 0)

legal_belligerence <- rbind(T2, T0)
legal_belligerence$ethnicity_scored <- 
  factor(legal_belligerence$ethnicity_scored)
legal_belligerence$subset_distinction <- 
  ifelse(legal_belligerence$Treatment == 2, 1, 0)

illegal_belligerence <- rbind(T5, T0)
illegal_belligerence$ethnicity_scored <- 
  factor(illegal_belligerence$ethnicity_scored)
illegal_belligerence$subset_distinction <- 
  ifelse(illegal_belligerence$Treatment == 5, 1, 0)

legal_inconsistency <- rbind(T3, T2)
legal_inconsistency$ethnicity_scored <- 
  factor(legal_inconsistency$ethnicity_scored)
legal_inconsistency$subset_distinction <- 
  ifelse(legal_inconsistency$Treatment == 3, 1, 0)

illegal_inconsistency <- rbind(T6, T5)
illegal_inconsistency$ethnicity_scored <- 
  factor(illegal_inconsistency$ethnicity_scored)
illegal_inconsistency$subset_distinction <- 
  ifelse(illegal_inconsistency$Treatment == 6, 1, 0)

legal_incompetence <- rbind(T2, T1)
legal_incompetence$ethnicity_scored <- 
  factor(legal_incompetence$ethnicity_scored)
legal_incompetence$subset_distinction <- 
  ifelse(legal_incompetence$Treatment == 2, 1, 0)

illegal_incompetence <- rbind(T5, T4)
illegal_incompetence$ethnicity_scored <- 
  factor(illegal_incompetence$ethnicity_scored)
illegal_incompetence$subset_distinction <- 
  ifelse(illegal_incompetence$Treatment == 5, 1, 0)

```

## Regression on Approval Rating Using All IVs/Explanatory Variables

```{r}

mod_approval_all <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + Treatment, data = d)

mod_approval_audience <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = audience)

mod_approval_belligerence <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = belligerence)

mod_approval_inconsistency <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = inconsistency)


mod_approval_incompetence <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = incompetence)

mod_approval_legal_audience <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_audience)

mod_approval_illegal_audience <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_audience)

mod_approval_legal_belligerence <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_belligerence)

mod_approval_illegal_belligerence <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_belligerence)

mod_approval_legal_inconsistency <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_inconsistency)

mod_approval_illegal_inconsistency <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_inconsistency)

mod_approval_legal_incompetence <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_incompetence)

mod_approval_illegal_incompetence <- lm(QID40 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_incompetence)

mod_approval_T0 <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T0)

mod_approval_T1 <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T1)

mod_approval_T2 <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T2)

mod_approval_T3 <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T3)

mod_approval_T4 <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T4)

mod_approval_T5 <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T5)

mod_approval_T6 <- lm(QID40 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T6)
```

## Regression on Voting Likelihood Using All IVs/Explanatory Variables

```{r}

mod_voting_all <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + Treatment, data = d)

mod_voting_interact <- lm(
  QID42 ~ factor(Treatment)*election_trump +
          factor(Treatment)*election_biden,
  data = d
)

mod_voting_audience <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = audience)

mod_voting_belligerence <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = belligerence)

mod_voting_inconsistency <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = inconsistency)


mod_voting_incompetence <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = incompetence)


mod_voting_legal_audience <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_audience)

mod_voting_illegal_audience <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_audience)

mod_voting_legal_belligerence <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_belligerence)

mod_voting_illegal_belligerence <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_belligerence)

mod_voting_legal_inconsistency <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_inconsistency)

mod_voting_illegal_inconsistency <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_inconsistency)

mod_voting_legal_incompetence <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_incompetence)

mod_voting_illegal_incompetence <- lm(QID42 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_incompetence)

mod_voting_T0 <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T0)

mod_voting_T1 <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T1)

mod_voting_T2 <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T2)

mod_voting_T3 <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T3)

mod_voting_T4 <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T4)

mod_voting_T5 <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T5)

mod_voting_T6 <- lm(QID42 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T6)
```

## Regression on Country Reputation Using All IVs/Explanatory Variables

```{r}

mod_us.reputation_all <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + Treatment, data = d)

mod_us.reputation_audience <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = audience)

mod_us.reputation_belligerence <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = belligerence)

mod_us.reputation_inconsistency <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = inconsistency)

mod_us.reputation_incompetence <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = incompetence)


mod_us.reputation_legal_audience <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_audience)

mod_us.reputation_illegal_audience <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_audience)

mod_us.reputation_legal_belligerence <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_belligerence)

mod_us.reputation_illegal_belligerence <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_belligerence)

mod_us.reputation_legal_inconsistency <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_inconsistency)

mod_us.reputation_illegal_inconsistency <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_inconsistency)

mod_us.reputation_legal_incompetence <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = legal_incompetence)

mod_us.reputation_illegal_incompetence <- lm(QID44 ~ milassert_score + chauvinism_score + 
                     QID59 + QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72 + subset_distinction, 
                     data = illegal_incompetence)

mod_us.reputation_T0 <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T0)

mod_us.reputation_T1 <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T1)

mod_us.reputation_T2 <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T2)

mod_us.reputation_T3 <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T3)

mod_us.reputation_T4 <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T4)

mod_us.reputation_T5 <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T5)

mod_us.reputation_T6 <- lm(QID44 ~ milassert_score + chauvinism_score + QID59 +
                     QID54 + QID55 + QID48 + lawknowledge_score + QID73 + 
                     QID74 + QID75 + QID76 + QID77 + QID78 + QID60 + 
                     QID64 + QID61 + political_party_dem + political_party_rep + 
                     political_party_independent + political_party_other + 
                     election_trump + election_biden + gender_male + age + 
                     ethnicity_scored + QID58 + hhi + education + 
                     QID70 + QID71 + QID72, data = T6)

```

## Exporting Columns of Text Responses for Coding and Analysis
```{r}

write.csv(d$QID41_TEXT, file = "text.responses_QID41.csv", row.names = FALSE)
d$MergedQID46.47 <- ifelse(d$QID46_TEXT == "", d$QID47_TEXT, d$QID46_TEXT)
write.csv(d$MergedQID46.47, file = "text.responses_QID46_QID47.csv", row.names = FALSE)
write.csv(d$QID80_TEXT, file = "text.responses_QID80.csv", row.names = FALSE)

filtered_data <- subset(d, Treatment == 3 & QID40 >= 3)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_lawfulaudcost.csv", row.names = FALSE)

filtered_data <- subset(d, Treatment == 6 & QID40 >= 3)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_unlawfulaudcost.csv", row.names = FALSE)

filtered_data <- subset(d, Treatment == 2 & QID40 >= 3)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_lawfulbelligerence.csv", row.names = FALSE)

filtered_data <- subset(d, Treatment == 5 & QID40 >= 3)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_unlawfulbelligerence.csv", row.names = FALSE)

filtered_data <- subset(d, milassert_score >= 3 & chauvinism_score <= 2)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_highmilassert_lowchauvinism.csv", row.names = FALSE)

filtered_data <- subset(d, chauvinism_score >= 3 & milassert_score <= 2)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_highchauvinism_lowmilassert.csv", row.names = FALSE)

filtered_data <- subset(d, political_party %in% c(1, 2))
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_democrats.csv", row.names = FALSE)

filtered_data <- subset(d, political_party %in% c(8, 9))
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_republicans.csv", row.names = FALSE)

filtered_data <- subset(d, lawknowledge_score > .5)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_highlawscore.csv", row.names = FALSE)

filtered_data <- subset(d, lawknowledge_score < .5)
write.csv(filtered_data$QID41_TEXT, file = "text.responses_QID41_lowlawscore.csv", row.names = FALSE)

filtered_data <- subset(d, milassert_score >= 3.5)
write.csv(filtered_data$QID46, file = "text.responses_QID46_highmilassert.csv", row.names = FALSE)

```

## Function to retrieve coefficients, SEs, and p-values from existing
## regressions and save as a one-column CSV file (to create regression tables)

```{r}

save_column_regtable_csv <- function(model) {
  options(digits = 5)
  model_name <- deparse(substitute(model))
  pvals <- coef(summary(model))[-1, "Pr(>|t|)"]
  stars <- ifelse(pvals < 0.1, "*", "")
  stars <- ifelse(pvals < 0.05, "**", stars)
  stars <- ifelse(pvals < 0.01, "***", stars)
  coefs <- coef(summary(model))[-1, "Estimate"]
  se <- coef(summary(model))[-1, "Std. Error"]
  coefs_str <- sprintf("%.5f", coefs)
  se_str <- sprintf("%.5f", abs(se))
  se_str <- paste0("(", se_str, ")")
  coefs_se_star <- paste0(coefs_str, stars)
  output <- c()
  for (i in seq_along(coefs)) {
    output <- c(output, coefs_se_star[i], se_str[i])
  }
  write.csv(data.frame(Title = output), file = paste0(model_name, ".csv"), row.names = FALSE)
  cat("Coefficients and standard errors for", model_name, "saved as", model_name, ".csv")
}

```

## Figure 2 Difference in Mean Approval Relative to Control in Percent (QID40)

```{r}

means <- d %>%
  group_by(Treatment) %>%
  summarise(
    mean = mean(QID40, na.rm = TRUE),
    se = sd(QID40, na.rm = TRUE) / sqrt(n())
  )

control_mean <- means$mean[means$Treatment == 0]

diff_df <- means %>%
  mutate(
    diff_raw  = mean - control_mean,
    lower_raw = diff_raw - 1.96 * se,
    upper_raw = diff_raw + 1.96 * se,
    diff  = diff_raw  * 20,
    lower = lower_raw * 20,
    upper = upper_raw * 20
  ) %>%
  filter(Treatment != 0) %>%
  mutate(
    pct_label = sprintf("%.1f%%", diff),
    Treatment = factor(
      Treatment,
      levels = rev(1:6),
      labels = rev(c(
        "Treatment 1:\nLegal, Follow\nThrough, Success",
        "Treatment 2:\nLegal, Follow\nThrough, Failure",
        "Treatment 3:\nLegal, Back Down",
        "Treatment 4:\nIllegal, Follow\nThrough, Success",
        "Treatment 5:\nIllegal, Follow\nThrough, Failure",
        "Treatment 6:\nIllegal, Back Down"
      ))
    )
  )

ggplot(diff_df, aes(x = Treatment, y = diff)) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red", size = 0.6) +
  geom_point(size = 2.5) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.15, size = 0.7) +

  geom_text(
    aes(label = pct_label),
    vjust = -0.9,
    hjust = 0.5,
    size = 3.2
  ) +
  scale_y_continuous(
  labels = function(x) sprintf("%.0f%%", x)
) +
  coord_flip() +
  theme_classic() +
  labs(
    x = "",
    y = "Difference in mean approval (% of scale, relative to control)"
  ) +
  theme(
    axis.text = element_text(size = 10),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_blank(),
    plot.title = element_blank()
  )

ggsave("Figure_DiffMeans_Approval_Relative_to_Control_Percent.png",
       width = 8, height = 5, dpi = 300)

pairwise_tests_approval <- pairwise.t.test(
  x = d$QID40,
  g = d$Treatment,
  p.adjust.method = "none"
)
pairwise_tests_approval

pairwise_tests_reputation <- pairwise.t.test(
  x = d$QID44,
  g = d$Treatment,
  p.adjust.method = "none"
)
pairwise_tests_reputation

```

## Figure 3 Inconsistency and Approval (QID40)

```{r}

compute_diff <- function(mean_backdown, se_backdown,
                         mean_followfail, se_followfail) {

  diff_raw <- mean_backdown - mean_followfail
  se_diff  <- sqrt(se_backdown^2 + se_followfail^2)
  diff_pct  <- diff_raw * 20
  lower_pct <- (diff_raw - 1.96 * se_diff) * 20
  upper_pct <- (diff_raw + 1.96 * se_diff) * 20
  list(diff = diff_pct, lower = lower_pct, upper = upper_pct)
}

m2 <- means %>% filter(Treatment == 2)
m3 <- means %>% filter(Treatment == 3)
m5 <- means %>% filter(Treatment == 5)
m6 <- means %>% filter(Treatment == 6)

lawful <- compute_diff(
  mean_backdown  = m3$mean,
  se_backdown    = m3$se,
  mean_followfail = m2$mean,
  se_followfail   = m2$se
)

unlawful <- compute_diff(
  mean_backdown  = m6$mean,
  se_backdown    = m6$se,
  mean_followfail = m5$mean,
  se_followfail   = m5$se
)

inconsistency_df <- tibble(
  Condition = factor(
    c("Internationally\nLawful", "Internationally\nUnlawful"),
    levels = c("Internationally\nLawful", "Internationally\nUnlawful")
  ),
  diff  = c(lawful$diff,  unlawful$diff),
  lower = c(lawful$lower, unlawful$lower),
  upper = c(lawful$upper, unlawful$upper)
) %>%
  mutate(
    pct_label = sprintf("%.1f%%", diff)
  )

ggplot(inconsistency_df, aes(x = Condition, y = diff)) +
  geom_hline(yintercept = 0, linetype = "dashed",
             color = "red", size = 0.6) +
  geom_point(size = 2.8) +
  geom_errorbar(aes(ymin = lower, ymax = upper),
                width = 0.15, size = 0.7) +
  geom_text(
    aes(label = pct_label),
    vjust = -0.9,
    hjust = 0.5,
    size = 3.2
  ) +
  scale_y_continuous(
    limits = c(-15, 15),
    labels = function(x) sprintf("%.0f%%", x)
  ) +
  coord_flip() +
  theme_classic() +
  labs(
    x = "",
    y = "Difference in mean approval\n(% of scale, 'back down' minus 'follow through and failure')"
  ) +
  theme(
    axis.text = element_text(size = 10),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_blank(),
    plot.title = element_blank()
  )

ggsave("Figure_Inconsistency_Approval_Percent.png",
       width = 6.55, height = 2.5, dpi = 300)

```

## Figure 4 Inconsistency and Reputation (QID44)

```{r}

rep_means <- d %>%
  group_by(Treatment) %>%
  summarise(
    mean = mean(QID44, na.rm = TRUE),
    se   = sd(QID44,  na.rm = TRUE) / sqrt(n())
  )

compute_rep_diff <- function(mean_backdown, se_backdown,
                             mean_followfail, se_followfail) {
  diff_raw <- mean_backdown - mean_followfail
  se_diff  <- sqrt(se_backdown^2 + se_followfail^2)
  diff_pct  <- diff_raw * 25
  lower_pct <- (diff_raw - 1.96 * se_diff) * 25
  upper_pct <- (diff_raw + 1.96 * se_diff) * 25
  list(diff = diff_pct, lower = lower_pct, upper = upper_pct)
}

r2 <- rep_means %>% filter(Treatment == 2)
r3 <- rep_means %>% filter(Treatment == 3)
r5 <- rep_means %>% filter(Treatment == 5)
r6 <- rep_means %>% filter(Treatment == 6)

lawful_rep <- compute_rep_diff(
  mean_backdown   = r3$mean,
  se_backdown     = r3$se,
  mean_followfail = r2$mean,
  se_followfail   = r2$se
)

unlawful_rep <- compute_rep_diff(
  mean_backdown   = r6$mean,
  se_backdown     = r6$se,
  mean_followfail = r5$mean,
  se_followfail   = r5$se
)

reputation_inconsistency_df <- tibble(
  Condition = factor(
    c("Internationally\nLawful", "Internationally\nUnlawful"),
    levels = c("Internationally\nLawful", "Internationally\nUnlawful")
  ),
  diff  = c(lawful_rep$diff,  unlawful_rep$diff),
  lower = c(lawful_rep$lower, unlawful_rep$lower),
  upper = c(lawful_rep$upper, unlawful_rep$upper)
) %>%
  mutate(
    pct_label = sprintf("%.1f%%", diff)
  )

ggplot(reputation_inconsistency_df, aes(x = Condition, y = diff)) +
  geom_hline(yintercept = 0, linetype = "dashed",
             color = "red", size = 0.6) +
  geom_point(size = 2.8) +
  geom_errorbar(aes(ymin = lower, ymax = upper),
                width = 0.15, size = 0.7) +
  geom_text(
    aes(label = pct_label),
    vjust = -0.9,
    hjust = 0.5,
    size  = 3.2
  ) +
  scale_y_continuous(
    limits = c(-15, 15),
    labels = function(x) sprintf("%.0f%%", x)
  ) +
  coord_flip() +
  theme_classic() +
  labs(
    x = "",
    y = "Difference in mean perceived reputational damage\n(% of scale, 'back down' minus 'follow through and failure')"
  ) +
  theme(
    axis.text   = element_text(size = 10),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_blank(),
    plot.title  = element_blank()
  )

ggsave("Figure_Reputation_Inconsistency_Percent.png",
       width = 6.55, height = 2.5, dpi = 300)

```

## Figure 5 Belligerence and Approval (QID40)

```{r}

compute_bell_diff <- function(mean_treat, se_treat,
                              mean_control, se_control) {
  diff_raw <- mean_treat - mean_control
  se_diff  <- sqrt(se_treat^2 + se_control^2)
  diff_pct  <- diff_raw * 20
  lower_pct <- (diff_raw - 1.96 * se_diff) * 20
  upper_pct <- (diff_raw + 1.96 * se_diff) * 20
  list(diff = diff_pct, lower = lower_pct, upper = upper_pct)
}

m0 <- means %>% filter(Treatment == 0)
m2 <- means %>% filter(Treatment == 2)
m5 <- means %>% filter(Treatment == 5)

lawful_bell <- compute_bell_diff(
  mean_treat   = m2$mean,
  se_treat     = m2$se,
  mean_control = m0$mean,
  se_control   = m0$se
)

unlawful_bell <- compute_bell_diff(
  mean_treat   = m5$mean,
  se_treat     = m5$se,
  mean_control = m0$mean,
  se_control   = m0$se
)

belligerence_df <- tibble(
  Condition = factor(
    c("Internationally\nLawful", "Internationally\nUnlawful"),
    levels = c("Internationally\nLawful", "Internationally\nUnlawful")
  ),
  diff  = c(lawful_bell$diff,  unlawful_bell$diff),
  lower = c(lawful_bell$lower, unlawful_bell$lower),
  upper = c(lawful_bell$upper, unlawful_bell$upper)
) %>%
  mutate(
    pct_label = sprintf("%.1f%%", diff)
  )

ggplot(belligerence_df, aes(x = Condition, y = diff)) +
  geom_hline(yintercept = 0, linetype = "dashed",
             color = "red", size = 0.6) +
  geom_point(size = 2.8) +
  geom_errorbar(aes(ymin = lower, ymax = upper),
                width = 0.15, size = 0.7) +
  geom_text(
    aes(label = pct_label),
    vjust = -0.9,
    hjust = 0.5,
    size  = 3.2
  ) +
  scale_y_continuous(
    limits = c(-15, 15),
    labels = function(x) sprintf("%.0f%%", x)
  ) +
  coord_flip() +
  theme_classic() +
  labs(
    x = "",
    y = "Difference in mean approval\n(% of scale, 'follow through and failure' minus 'stay out')"
  ) +
  theme(
    axis.text    = element_text(size = 10),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_blank(),
    plot.title   = element_blank()
  )

ggsave("Figure_Belligerence_Approval_Percent.png",
       width = 6.55, height = 2.5, dpi = 300)

```

## Figure 6 Belligerence and Reputation (QID44)

```{r}

compute_rep_bell_diff <- function(mean_treat, se_treat,
                                  mean_control, se_control) {
  diff_raw <- mean_treat - mean_control
  se_diff  <- sqrt(se_treat^2 + se_control^2)
  diff_pct  <- diff_raw * 25
  lower_pct <- (diff_raw - 1.96 * se_diff) * 25
  upper_pct <- (diff_raw + 1.96 * se_diff) * 25
  list(diff = diff_pct, lower = lower_pct, upper = upper_pct)
}

r0 <- rep_means %>% filter(Treatment == 0)
r2 <- rep_means %>% filter(Treatment == 2)
r5 <- rep_means %>% filter(Treatment == 5)

lawful_rep_bell <- compute_rep_bell_diff(
  mean_treat   = r2$mean,
  se_treat     = r2$se,
  mean_control = r0$mean,
  se_control   = r0$se
)

unlawful_rep_bell <- compute_rep_bell_diff(
  mean_treat   = r5$mean,
  se_treat     = r5$se,
  mean_control = r0$mean,
  se_control   = r0$se
)

reputation_belligerence_df <- tibble(
  Condition = factor(
    c("Internationally\nLawful", "Internationally\nUnlawful"),
    levels = c("Internationally\nLawful", "Internationally\nUnlawful")
  ),
  diff  = c(lawful_rep_bell$diff,  unlawful_rep_bell$diff),
  lower = c(lawful_rep_bell$lower, unlawful_rep_bell$lower),
  upper = c(lawful_rep_bell$upper, unlawful_rep_bell$upper)
) %>%
  mutate(
    pct_label = sprintf("%.1f%%", diff)
  )

ggplot(reputation_belligerence_df, aes(x = Condition, y = diff)) +
  geom_hline(yintercept = 0, linetype = "dashed",
             color = "red", size = 0.6) +
  geom_point(size = 2.8) +
  geom_errorbar(aes(ymin = lower, ymax = upper),
                width = 0.15, size = 0.7) +
  geom_text(
    aes(label = pct_label),
    vjust = -0.9,
    hjust = 0.5,
    size  = 3.2
  ) +
  scale_y_continuous(
    limits = c(-15, 15),
    labels = function(x) sprintf("%.0f%%", x)
  ) +
  coord_flip() +
  theme_classic() +
  labs(
    x = "",
    y = "Difference in mean perceived reputational damage\n(% of scale, 'follow through and failure' minus 'stay out')"
  ) +
  theme(
    axis.text    = element_text(size = 10),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_blank(),
    plot.title   = element_blank()
  )

ggsave("Figure_Belligerence_Reputation_Percent.png",
       width = 6.55, height = 2.5, dpi = 300)

```

## Figure 7 Incompetence and Approval (QID40)

```{r}

compute_incomp_diff <- function(mean_fail, se_fail,
                                mean_success, se_success) {

  diff_raw <- mean_fail - mean_success
  se_diff  <- sqrt(se_fail^2 + se_success^2)
  diff_pct  <- diff_raw * 20
  lower_pct <- (diff_raw - 1.96 * se_diff) * 20
  upper_pct <- (diff_raw + 1.96 * se_diff) * 20
  list(diff = diff_pct, lower = lower_pct, upper = upper_pct)
}

m1 <- means %>% filter(Treatment == 1)
m2 <- means %>% filter(Treatment == 2)
m4 <- means %>% filter(Treatment == 4)
m5 <- means %>% filter(Treatment == 5)

lawful_incomp <- compute_incomp_diff(
  mean_fail    = m2$mean,
  se_fail      = m2$se,
  mean_success = m1$mean,
  se_success   = m1$se
)

unlawful_incomp <- compute_incomp_diff(
  mean_fail    = m5$mean,
  se_fail      = m5$se,
  mean_success = m4$mean,
  se_success   = m4$se
)

incompetence_df <- tibble(
  Condition = factor(
    c("Internationally\nLawful", "Internationally\nUnlawful"),
    levels = c("Internationally\nLawful", "Internationally\nUnlawful")
  ),
  diff  = c(lawful_incomp$diff,  unlawful_incomp$diff),
  lower = c(lawful_incomp$lower, unlawful_incomp$lower),
  upper = c(lawful_incomp$upper, unlawful_incomp$upper)
) %>%
  mutate(
    pct_label = sprintf("%.1f%%", diff)
  )

ggplot(incompetence_df, aes(x = Condition, y = diff)) +
  geom_hline(yintercept = 0, linetype = "dashed",
             color = "red", size = 0.6) +
  geom_point(size = 2.8) +
  geom_errorbar(aes(ymin = lower, ymax = upper),
                width = 0.15, size = 0.7) +
  geom_text(
    aes(label = pct_label),
    vjust = -0.9,
    hjust = 0.5,
    size  = 3.2
  ) +
  scale_y_continuous(
    limits = c(-15, 15),
    labels = function(x) sprintf("%.0f%%", x)
  ) +
  coord_flip() +
  theme_classic() +
  labs(
    x = "",
    y = "Difference in mean approval\n(% of scale, 'follow through and failure' minus 'follow through and success')"
  ) +
  theme(
    axis.text    = element_text(size = 10),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_blank(),
    plot.title   = element_blank()
  )

ggsave("Figure_Incompetence_Approval_Percent.png",
       width = 6.55, height = 2.5, dpi = 300)

```

## Figure 8 Incompetence and Reputation (QID44)

```{r}

compute_rep_incomp_diff <- function(mean_fail, se_fail,
                                    mean_success, se_success) {
  diff_raw <- mean_fail - mean_success
  se_diff  <- sqrt(se_fail^2 + se_success^2)
  diff_pct  <- diff_raw * 25
  lower_pct <- (diff_raw - 1.96 * se_diff) * 25
  upper_pct <- (diff_raw + 1.96 * se_diff) * 25
  list(diff = diff_pct, lower = lower_pct, upper = upper_pct)
}

r1 <- rep_means %>% filter(Treatment == 1)
r2 <- rep_means %>% filter(Treatment == 2)
r4 <- rep_means %>% filter(Treatment == 4)
r5 <- rep_means %>% filter(Treatment == 5)

lawful_rep_incomp <- compute_rep_incomp_diff(
  mean_fail    = r2$mean,
  se_fail      = r2$se,
  mean_success = r1$mean,
  se_success   = r1$se
)

unlawful_rep_incomp <- compute_rep_incomp_diff(
  mean_fail    = r5$mean,
  se_fail      = r5$se,
  mean_success = r4$mean,
  se_success   = r4$se
)

reputation_incompetence_df <- tibble(
  Condition = factor(
    c("Internationally\nLawful", "Internationally\nUnlawful"),
    levels = c("Internationally\nLawful", "Internationally\nUnlawful")
  ),
  diff  = c(lawful_rep_incomp$diff,  unlawful_rep_incomp$diff),
  lower = c(lawful_rep_incomp$lower, unlawful_rep_incomp$lower),
  upper = c(lawful_rep_incomp$upper, unlawful_rep_incomp$upper)
) %>%
  mutate(
    pct_label = sprintf("%.1f%%", diff)
  )

ggplot(reputation_incompetence_df, aes(x = Condition, y = diff)) +
  geom_hline(yintercept = 0, linetype = "dashed",
             color = "red", size = 0.6) +
  geom_point(size = 2.8) +
  geom_errorbar(aes(ymin = lower, ymax = upper),
                width = 0.15, size = 0.7) +
  geom_text(
    aes(label = pct_label),
    vjust = -0.9,
    hjust = 0.5,
    size  = 3.2
  ) +
  scale_y_continuous(
    limits = c(-15, 15),
    labels = function(x) sprintf("%.0f%%", x)
  ) +
  coord_flip() +
  theme_classic() +
  labs(
    x = "",
    y = "Difference in mean perceived reputational damage\n(% of scale, 'follow through and failure' minus 'follow through and success')"
  ) +
  theme(
    axis.text    = element_text(size = 10),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_blank(),
    plot.title   = element_blank()
  )

ggsave("Figure_Incompetence_Reputation_Percent.png",
       width = 6.55, height = 2.5, dpi = 300)

```

## Figure 9 Mil Assert and Natl Chauvinism (milassert_score and chauvinism_score)

```{r}

mods_by_treat <- list(
  "Control:\nStay out"                              = mod_approval_T0,
  "Treatment 1:\nLegal, Follow\nThrough, Success"   = mod_approval_T1,
  "Treatment 2:\nLegal, Follow\nThrough, Failure"   = mod_approval_T2,
  "Treatment 3:\nLegal,\nBack down"                 = mod_approval_T3,
  "Treatment 4:\nIllegal, Follow\nThrough, Success" = mod_approval_T4,
  "Treatment 5:\nIllegal, Follow\nThrough, Failure" = mod_approval_T5,
  "Treatment 6:\nIllegal,\nBack down"               = mod_approval_T6
)

extract_coef <- function(mod_list, term_name) {
  purrr::imap_dfr(mod_list, ~ {
    broom::tidy(.x) %>%
      dplyr::filter(term == term_name) %>%
      dplyr::transmute(
        Treatment = .y,
        estimate  = estimate,
        se        = std.error
      )
  })
}

mil_df <- extract_coef(mods_by_treat, "milassert_score") %>%
  dplyr::mutate(
    Predictor = "Militant assertiveness",
    ymin      = estimate - 1.96 * se,
    ymax      = estimate + 1.96 * se
  )

chauv_df <- extract_coef(mods_by_treat, "chauvinism_score") %>%
  dplyr::mutate(
    Predictor = "National chauvinism",
    ymin      = estimate - 1.96 * se,
    ymax      = estimate + 1.96 * se
  )

treat_levels <- rev(names(mods_by_treat))

coef_df <- dplyr::bind_rows(mil_df, chauv_df) %>%
  dplyr::mutate(
    Treatment = factor(Treatment, levels = treat_levels),
    Predictor = factor(
      Predictor,
      levels = c("Militant assertiveness", "National chauvinism")
    )
  )

all_bounds <- c(coef_df$ymin, coef_df$ymax)
x_lim <- max(abs(all_bounds))
x_lim <- ceiling(x_lim * 10) / 10

fig9 <- ggplot(coef_df, aes(x = estimate, y = Treatment)) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  geom_point(size = 2.5) +
  geom_errorbarh(aes(xmin = ymin, xmax = ymax),
                 height = 0.15, size = 0.7) +
  geom_text(
    aes(label = sprintf("%.2f", estimate)),
    nudge_y = 0.25,
    size    = 3
  ) +
  scale_x_continuous(limits = c(-1.35, 1.35)) +
  facet_grid(. ~ Predictor) +
  theme_classic() +
  labs(
    x = "Coefficient (effect on approval)",
    y = ""
  ) +
  theme(
    strip.text      = element_text(size = 11),
    axis.text.y     = element_text(size = 9),
    axis.text.x     = element_text(size = 9),
    axis.title.x    = element_text(size = 9),
    plot.title      = element_blank(),
    panel.spacing.x = unit(2, "lines"),
    legend.position = "none"
  )

ggsave(
  "Figure_MilAssert_Chauvinism_Approval.png",
  plot   = fig9,
  width  = 8,
  height = 4.5,
  dpi    = 300
)

```

## Figure 10 Voting Likelihood (QID42) and 2020 Vote Choice 
## (election_trump and election_biden)

```{r}

mods_voting_by_treat <- list(
  "Control:\nStay out"                              = mod_voting_T0,
  "Treatment 1:\nLegal, Follow\nThrough, Success"   = mod_voting_T1,
  "Treatment 2:\nLegal, Follow\nThrough, Failure"   = mod_voting_T2,
  "Treatment 3:\nLegal,\nBack down"                 = mod_voting_T3,
  "Treatment 4:\nIllegal, Follow\nThrough, Success" = mod_voting_T4,
  "Treatment 5:\nIllegal, Follow\nThrough, Failure" = mod_voting_T5,
  "Treatment 6:\nIllegal,\nBack down"               = mod_voting_T6
)

extract_coef <- function(mod_list, term_name) {
  purrr::imap_dfr(mod_list, ~ {
    broom::tidy(.x) %>%
      dplyr::filter(term == term_name) %>%
      dplyr::transmute(
        Treatment = .y,
        estimate  = estimate,
        se        = std.error
      )
  })
}

trump_df <- extract_coef(mods_voting_by_treat, "election_trump") %>%
  dplyr::mutate(
    Predictor = "Supported Trump\nin 2020 election",
    ymin      = estimate - 1.96 * se,
    ymax      = estimate + 1.96 * se
  )

biden_df <- extract_coef(mods_voting_by_treat, "election_biden") %>%
  dplyr::mutate(
    Predictor = "Supported Biden\nin 2020 election",
    ymin      = estimate - 1.96 * se,
    ymax      = estimate + 1.96 * se
  )

treat_levels <- rev(names(mods_voting_by_treat))

coef_vote_df <- dplyr::bind_rows(trump_df, biden_df) %>%
  dplyr::mutate(
    Treatment = factor(Treatment, levels = treat_levels),
    Predictor = factor(
      Predictor,
      levels = c("Supported Trump\nin 2020 election",
                 "Supported Biden\nin 2020 election")
    )
  )

all_bounds <- c(coef_vote_df$ymin, coef_vote_df$ymax)
x_lim <- max(abs(all_bounds))
x_lim <- ceiling(x_lim * 10) / 10

fig_trump_biden <- ggplot(coef_vote_df, aes(x = estimate, y = Treatment)) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  geom_point(size = 2.5) +
  geom_errorbarh(aes(xmin = ymin, xmax = ymax),
                 height = 0.15, size = 0.7) +
  geom_text(
    aes(label = sprintf("%.2f", estimate)),
    nudge_y = 0.25,
    size    = 3
  ) +
  scale_x_continuous(limits = c(-1.35, 1.35)) +
  facet_grid(. ~ Predictor) +
  theme_classic() +
  labs(
    x = "Coefficient (effect on voting likelihood)",
    y = ""
  ) +
  theme(
    strip.text      = element_text(size = 11),
    axis.text.y     = element_text(size = 9),
    axis.text.x     = element_text(size = 9),
    axis.title.x    = element_text(size = 9),
    plot.title      = element_blank(),
    panel.spacing.x = unit(2, "lines"),
    legend.position = "none"
  )

ggsave(
  "Figure_Trump_Biden_VotingLikelihood.png",
  plot   = fig_trump_biden,
  width  = 8,
  height = 4.5,
  dpi    = 300
)

```


